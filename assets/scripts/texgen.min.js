var TG={};TG.Texture=function(r,t){return this.width=r,this.height=t,this.array=new Float32Array(r*t*4),this},TG.Texture.prototype={constructor:TG.Texture,pass:function(r,t){void 0===t&&(t="");var n=r.getColor(),e=r.getSource(),o=["var x = 0, y = 0;","for ( var i = 0, il = array.length; i < il; i += 4 ) {"," "+e,0!==n[0]?"  array[ i + 0 ] "+t+"= color * "+n[0]+";":"",0!==n[1]?"  array[ i + 1 ] "+t+"= color * "+n[1]+";":"",0!==n[2]?"  array[ i + 2 ] "+t+"= color * "+n[2]+";":""," if ( ++x === width ) { x = 0; y ++; }","}"].join("\n");return new Function("array, width, height",o)(this.array,this.width,this.height),this},add:function(r){return this.pass(r,"+")},sub:function(r){return this.pass(r,"-")},mul:function(r){return this.pass(r,"*")},div:function(r){return this.pass(r,"/")},toCanvas:function(){var r=this.width,t=this.height,n=this.array,e=document.createElement("canvas");e.width=r,e.height=t;for(var o=e.getContext("2d"),i=o.createImageData(r,t),u=i.data,a=0,c=n.length;c>a;a+=4)u[a]=255*n[a],u[a+1]=255*n[a+1],u[a+2]=255*n[a+2],u[a+3]=255;return o.putImageData(i,0,0),e}},TG.Program=function(r){var t=[1,1,1];return r.color=function(r,n,e){return t=[r,n,e],this},r.getColor=function(){return t},r},TG.Number=function(){return new TG.Program({getSource:function(){return"var color = 1;"}})},TG.SinX=function(){var r=1,t=0;return new TG.Program({frequency:function(t){return r=t*Math.PI,this},offset:function(r){return t=r,this},getSource:function(){return"var color = Math.sin( ( x + "+t+" ) * "+r+" );"}})},TG.SinY=function(){var r=1,t=0;return new TG.Program({frequency:function(t){return r=t*Math.PI,this},offset:function(r){return t=r,this},getSource:function(){return"var color = Math.sin( ( y + "+t+" ) * "+r+" );"}})},TG.OR=function(){return new TG.Program({getSource:function(){return"var color = ( x | y ) / width;"}})},TG.XOR=function(){return new TG.Program({getSource:function(){return"var color = ( x ^ y ) / width;"}})},TG.Noise=function(){return new TG.Program({getSource:function(){return"var color = Math.random();"}})};var texture=new TG.Texture(1500,800).add((new TG.SinX).frequency(.001).color(1,0,0)).add((new TG.SinY).frequency(.1).color(.5,.5,.5)).toCanvas();document.body.appendChild(texture);